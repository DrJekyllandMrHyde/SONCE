machine:
  node:
    version: 4.4

general:
  branches:
    only:
      - master
      - develop

dependencies:
  override:
    - node --version
    - npm --version
    - if [ ! -f .meteor/meteor ]; then curl https://install.meteor.com | sh; fi
    - meteor node --version
    - meteor npm --version
    - npm install
    - meteor build --architecture=os.linux.x86_64 --directory ../app --server=http://localhost:3000
    - cd ../app/bundle/programs/server
    - npm install --production
    - cd ../app/bundle
  cache_directories:
    - .meteor

test:
  override:
    - cd ../app/bundle
